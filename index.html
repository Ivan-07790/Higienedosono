<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O C√≥digo do Sono - Guia Interativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: A task-oriented SPA designed to guide the user through a journey of sleep improvement. It starts with an interactive quiz for personalization, leading to a dynamic, customized action plan. This is followed by a "Deep Dive Library" for non-linear exploration of all topics, and an "Interactive Tools" section for practical application (like a ritual builder and breathing guide). This structure is chosen to increase engagement and provide actionable value upfront, making the final offer of the e-book and main product more compelling than a simple content presentation. -->
    <!-- Visualization & Content Choices: The app uses interactive elements to achieve specific goals. 1) Quiz (Inform/Engage): HTML forms + JS logic to assess user habits and generate a personalized score, making the content relevant. 2) Personalized Plan (Guide): Dynamically updated HTML blocks to present focused recommendations. 3) Library (Organize/Inform): A filterable grid of cards with modals (JS show/hide) to present detailed e-book content in a digestible, on-demand format. 4) Breathing Guide (Instruct): An animated HTML Canvas element visually guides the user through the 4x4 breathing technique, turning a textual instruction into an experiential tool. These choices prioritize user interaction and practical application over static data display. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .calm-shadow {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        .calm-shadow-lg {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.07);
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        .breathing-dot {
            transition: transform 3.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="antialiased">
    <div id="top-countdown-bar" class="sticky top-0 z-50 bg-red-500 text-white text-sm font-semibold text-center p-1 hidden">
        <div class="flex justify-center items-center gap-3 md:gap-4">
            <span class="hidden sm:inline">Aten√ß√£o: Sua oferta especial expira em:</span>
            <div class="relative w-1/4 sm:w-1/3 bg-white/30 rounded-full h-2.5">
                <div id="progress-bar" class="bg-white h-2.5 rounded-full" style="width: 70%"></div>
            </div>
            <div id="top-timer" class="font-mono text-xs">
                <span id="top-hours">00</span>:<span id="top-minutes">00</span>:<span id="top-seconds">00</span>
            </div>
        </div>
    </div>

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 calm-shadow">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-[#4A5568]">
                <span class="text-[#8C7A6B]">‚òæ</span> O C√≥digo do Sono
            </div>
            <div class="hidden md:flex space-x-6 text-gray-700">
                <a href="#diagnostico" class="hover:text-[#8C7A6B] transition-colors">Diagn√≥stico</a>
                <a href="#biblioteca" class="hover:text-[#8C7A6B] transition-colors">Biblioteca</a>
                <a href="#ferramentas" class="hover:text-[#8C7A6B] transition-colors">Ferramentas</a>
                <a href="#oferta" class="bg-[#8C7A6B] text-white px-4 py-2 rounded-full hover:bg-[#7a6a5a] transition-all duration-300">Baixar o Guia</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-2xl">‚ò∞</button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
             <a href="#diagnostico" class="block hover:text-[#8C7A6B] transition-colors">Diagn√≥stico</a>
             <a href="#biblioteca" class="block hover:text-[#8C7A6B] transition-colors">Biblioteca</a>
             <a href="#ferramentas" class="block hover:text-[#8C7A6B] transition-colors">Ferramentas</a>
             <a href="#oferta" class="block mt-2 bg-[#8C7A6B] text-white px-4 py-2 rounded-full hover:bg-[#7a6a5a] transition-all duration-300 text-center">Baixar o Guia</a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <section id="hero" class="text-center mb-20">
            <h1 class="text-4xl md:text-6xl font-bold text-[#4A5568] mb-4 leading-tight">Noites em claro? Nunca mais.</h1>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">Sente que seu corpo "desaprendeu" a dormir? Descubra o passo a passo para voltar a dormir bem e ter mais energia no seu dia.</p>
            <a href="#diagnostico" class="bg-[#A49180] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#8C7A6B] transition-all duration-300 transform hover:scale-105">Come√ßar Diagn√≥stico R√°pido</a>
        </section>

        <section id="diagnostico" class="mb-20 scroll-mt-24">
            <div class="bg-white rounded-lg p-8 md:p-12 calm-shadow-lg">
                <h2 class="text-3xl font-bold text-center text-[#4A5568] mb-2">Diagn√≥stico R√°pido do Sono</h2>
                <p class="text-center text-gray-600 mb-8">Responda 5 perguntas para descobrir os pontos que mais impactam suas noites.</p>
                <div id="quiz-container"></div>
                <div class="text-center mt-8">
                    <button id="submit-quiz" class="bg-[#8C7A6B] text-white px-8 py-3 rounded-full text-lg font-semibold hover:bg-[#7a6a5a] transition-colors disabled:bg-gray-400" disabled>Ver Meu Plano de A√ß√£o</button>
                </div>
            </div>
        </section>

        <section id="plano-de-acao" class="hidden mb-20 scroll-mt-24">
             <div class="bg-emerald-50 rounded-lg p-8 md:p-12 border border-emerald-200">
                <h2 class="text-3xl font-bold text-center text-emerald-800 mb-2">Seu Plano de A√ß√£o Inicial</h2>
                <p class="text-center text-emerald-700 mb-8">Com base nas suas respostas, aqui est√£o as 3 √°reas de maior impacto para voc√™ focar primeiro.</p>
                <div id="plan-content" class="grid md:grid-cols-3 gap-6 text-center">
                </div>
            </div>
        </section>


        <section id="biblioteca" class="mb-20 scroll-mt-24">
            <h2 class="text-3xl font-bold text-center text-[#4A5568] mb-2">Biblioteca do Sono</h2>
            <p class="text-center text-gray-600 mb-8">Explore todos os pilares da higiene do sono. Clique em um card para aprender mais.</p>
            <div id="library-filters" class="flex justify-center flex-wrap gap-3 mb-8"></div>
            <div id="library-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </section>

        <section id="ferramentas" class="mb-20 scroll-mt-24">
            <h2 class="text-3xl font-bold text-center text-[#4A5568] mb-2">Ferramentas Interativas</h2>
            <p class="text-center text-gray-600 mb-8">Use estas ferramentas para colocar em pr√°tica o que aprendeu.</p>
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg p-8 calm-shadow-lg">
                    <h3 class="font-bold text-xl mb-4 text-[#4A5568]">‚òæ Construtor do Ritual Noturno</h3>
                    <p class="text-gray-600 mb-4">Selecione as atividades que voc√™ ir√° incluir no seu ritual de 60 minutos antes de dormir.</p>
                    <div id="ritual-builder" class="space-y-3"></div>
                     <button id="save-ritual" class="mt-6 w-full bg-[#8C7A6B] text-white px-6 py-2 rounded-full font-semibold hover:bg-[#7a6a5a] transition-colors">Salvar Meu Ritual</button>
                     <p id="ritual-saved-message" class="text-center mt-2 text-green-600 hidden">Ritual salvo com sucesso!</p>
                </div>
                <div class="bg-white rounded-lg p-8 calm-shadow-lg">
                    <h3 class="font-bold text-xl mb-4 text-[#4A5568]">üßò Guia de Respira√ß√£o 4x4</h3>
                    <p class="text-gray-600 mb-4">Use esta anima√ß√£o para guiar sua respira√ß√£o, acalmar a mente e preparar o corpo para o sono.</p>
                    <div class="relative w-48 h-48 mx-auto flex items-center justify-center cursor-pointer">
                        <div id="breathing-circle-bg" class="absolute w-full h-full bg-[#EAE3DC] rounded-full"></div>
                        <div id="breathing-circle" class="absolute w-8 h-8 bg-[#8C7A6B] rounded-full breathing-dot"></div>
                        <span id="breathing-text" class="text-lg font-semibold text-[#4A5568]">Clique</span>
                    </div>
                     <p class="text-xs text-center text-gray-500 mt-2 italic">Clique no c√≠rculo para iniciar ou pausar.</p>
                </div>
            </div>
        </section>

        <section id="oferta" class="bg-gradient-to-r from-[#eae3dc] to-[#dcd1c6] rounded-lg p-8 md:p-12 calm-shadow-lg text-center scroll-mt-24">
            <h2 class="text-3xl font-bold text-[#4A5568] mb-4">Transforme suas noites de vez com o guia completo!</h2>
            
            <div id="countdown-wrapper" class="mb-8 hidden">
                <p class="text-lg text-gray-700 font-semibold">Esta oferta especial termina em:</p>
                <div id="countdown" class="text-4xl md:text-5xl font-bold text-[#4A5568] flex justify-center space-x-2 md:space-x-4 mt-2">
                    <div><span id="hours">00</span><span class="block text-sm font-normal">Horas</span></div>
                    <div class="font-bold text-3xl">:</div>
                    <div><span id="minutes">00</span><span class="block text-sm font-normal">Minutos</span></div>
                    <div class="font-bold text-3xl">:</div>
                    <div><span id="seconds">00</span><span class="block text-sm font-normal">Segundos</span></div>
                </div>
            </div>
            <div id="countdown-expired" class="hidden text-2xl font-bold text-red-600 mt-4 mb-8">Oferta Encerrada!</div>

            <p class="text-lg text-gray-700 max-w-3xl mx-auto mb-8">Tenha acesso ao guia **"O C√≥digo do Sono"** e receba o passo a passo detalhado, checklists e os desafios pr√°ticos para solidificar seus novos h√°bitos.</p>
            
            <div class="my-10 text-left max-w-2xl mx-auto bg-white/50 p-6 rounded-lg border border-white">
                <h3 class="text-2xl font-bold text-[#4A5568] mb-4 text-center">O que voc√™ vai decifrar no guia:</h3>
                <ul class="space-y-3 text-gray-700">
                    <li class="flex items-start"><span class="text-emerald-600 mr-2 mt-1">‚úî</span> <strong>Cap√≠tulo 1: O Pre√ßo de Uma Noite em Branco</strong> - Os perigos que a falta de sono causa no seu corpo e mente.</li>
                    <li class="flex items-start"><span class="text-emerald-600 mr-2 mt-1">‚úî</span> <strong>Cap√≠tulo 2: O Diagn√≥stico</strong> - Entenda os verdadeiros ladr√µes do seu sono.</li>
                    <li class="flex items-start"><span class="text-emerald-600 mr-2 mt-1">‚úî</span> <strong>Cap√≠tulo 3: Os 5 Pilares do Sono</strong> - O passo a passo para criar o ambiente, a rotina e os h√°bitos perfeitos.</li>
                    <li class="flex items-start"><span class="text-emerald-600 mr-2 mt-1">‚úî</span> <strong>Cap√≠tulo 4: Ferramentas Pr√°ticas</strong> - Um construtor de rituais e a poderosa t√©cnica de respira√ß√£o.</li>
                    <li class="flex items-start"><span class="text-emerald-600 mr-2 mt-1">‚úî</span> <strong>B√îNUS: Cap√≠tulo 5: O Desafio dos 7 Dias</strong> - Atividades e miss√µes avan√ßadas para transformar seu sono de vez.</li>
                </ul>
            </div>

            <div class="my-8">
                <span class="text-2xl text-gray-500 line-through">De R$ 85,00</span>
                <p class="text-lg text-gray-700">Por apenas:</p>
                <p class="text-5xl font-extrabold text-emerald-600 my-2">R$ 19,90</p>
            </div>

            <button id="open-checkout-btn" class="bg-[#4A5568] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#394251] transition-all duration-300 transform hover:scale-105">Garantir meu Guia Agora!</button>
        </section>

    </main>

    <footer class="text-center py-8 border-t border-gray-200">
        <p class="text-sm text-gray-500">&copy; 2025 O C√≥digo do Sono. Todos os direitos reservados.</p>
    </footer>

    <div id="modal-container" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0"></div>
        <div id="modal-content" class="relative bg-white w-11/12 md:max-w-2xl mx-auto rounded-lg shadow-lg p-8 max-h-[80vh] overflow-y-auto">
            <button id="modal-close" class="absolute top-4 right-4 text-2xl text-gray-500 hover:text-gray-800">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const data = {
                quiz: [
                    {
                        question: "Seus hor√°rios de dormir e acordar s√£o uma bagun√ßa ou voc√™ √© mais regrado?",
                        options: ["üòá Sou um reloginho, durmo e acordo quase sempre na mesma hora.", "ü§î Durante a semana at√© tento, mas no fim de semana a rotina some.", "üòµ √â uma bagun√ßa. Cada noite durmo em um hor√°rio diferente."],
                        category: "Rotina"
                    },
                    {
                        question: "Com que frequ√™ncia voc√™ usa o celular ou assiste TV na cama antes de dormir?",
                        options: ["üòá Nunca ou raramente.", "ü§î Algumas vezes por semana.", "üòµ Quase todas as noites."],
                        category: "Est√≠mulos"
                    },
                    {
                        question: "Como √© o seu quarto na hora de dormir?",
                        options: ["üòá Totalmente escuro, silencioso e fresco.", "ü§î Tem um pouco de luz ou ru√≠do.", "üòµ Muitas luzes de aparelhos ou barulho externo."],
                        category: "Ambiente"
                    },
                    {
                        question: "Voc√™ consome bebidas com cafe√≠na (caf√©, energ√©ticos) ap√≥s as 15h?",
                        options: ["üòá N√£o, evito completamente.", "ü§î Ocasionalmente.", "üòµ Sim, com frequ√™ncia."],
                        category: "H√°bitos"
                    },
                    {
                        question: "Se voc√™ acorda de madrugada, qual sua rea√ß√£o mais comum?",
                        options: ["üòá Fico relaxado e geralmente volto a dormir.", "ü§î Olho o rel√≥gio e fico um pouco ansioso.", "üòµ Pego o celular ou me levanto e acendo a luz."],
                        category: "Emerg√™ncia"
                    }
                ],
                library: [
                    { id: 1, category: "Ambiente", title: "O Santu√°rio do Sono", content: `<h3>Preparando o Seu Ambiente</h3><p>Seu quarto precisa ser um ref√∫gio, associado exclusivamente ao descanso. Tr√™s pilares s√£o essenciais:</p><ul><li class="mt-2"><strong>Escurid√£o Total:</strong> A luz inibe a melatonina. Use cortinas blackout e cubra luzes de eletr√¥nicos.</li><li class="mt-2"><strong>Sil√™ncio:</strong> Ru√≠dos fragmentam o sono. Considere tamp√µes de ouvido ou ru√≠do branco.</li><li class="mt-2"><strong>Temperatura Fresca:</strong> Um ambiente entre 18¬∞C e 21¬∞C ajuda o corpo a iniciar o sono.</li></ul><p class="mt-4 font-semibold">Lembrete: A cama √© para dormir e ter rela√ß√µes √≠ntimas. Evite trabalhar ou comer nela para fortalecer a associa√ß√£o mental com o descanso.</p>` },
                    { id: 2, category: "Rotina", title: "O Rel√≥gio Interno", content: `<h3>A Magia da Rotina</h3><p>Nosso corpo tem um rel√≥gio biol√≥gico (ciclo circadiano) que ama consist√™ncia. Ajust√°-lo √© fundamental.</p><ul><li class="mt-2"><strong>Hor√°rios Fixos:</strong> O pilar mais importante. Tente dormir e, principalmente, acordar no mesmo hor√°rio todos os dias, incluindo fins de semana.</li><li class="mt-2"><strong>Luz Solar Matinal:</strong> Exponha-se √† luz natural na primeira hora do dia para "zerar" seu rel√≥gio.</li><li class="mt-2"><strong>Luzes Noturnas:</strong> Reduza a intensidade das luzes em casa √† noite. Troque luzes brancas por amarelas para sinalizar ao c√©rebro que o dia est√° acabando.</li></ul>` },
                    { id: 3, category: "Rotina", title: "Gerenciando Cochilos", content: `<h3>O Poder do Cochilo Certo</h3><p>Cochilos podem ajudar, mas se feitos da forma errada, atrapalham o sono noturno.</p><ul><li class="mt-2"><strong>Dura√ß√£o:</strong> De 15 a 30 minutos no m√°ximo. Mais que isso pode causar in√©rcia do sono.</li><li class="mt-2"><strong>Hor√°rio:</strong> Evite cochilar ap√≥s as 15h para n√£o diminuir a "press√£o de sono" acumulada para a noite.</li></ul>` },
                    { id: 4, category: "Est√≠mulos", title: "O Ritual de Desacelera√ß√£o", content: `<h3>O Preparo para a Noite</h3><p>O c√©rebro precisa de um tempo de transi√ß√£o para desligar. Crie um ritual relaxante de 60 minutos.</p><ul><li class="mt-2"><strong>Desconecte-se das Telas:</strong> A luz azul inibe a melatonina. Desligue celular, TV e computador uma hora antes de dormir.</li><li class="mt-2"><strong>Atividades Calmas:</strong> Opte por um banho quente, leitura de um livro f√≠sico, medita√ß√£o ou m√∫sica tranquila.</li><li class="mt-2"><strong>Esvazie a Mente:</strong> Anote preocupa√ß√µes ou tarefas do dia seguinte em um caderno para liberar a mente.</li></ul>` },
                    { id: 5, category: "Emerg√™ncia", title: "Guia de Emerg√™ncia", content: `<h3>Acordou no Meio da Noite?</h3><p>√â normal, mas a rea√ß√£o errada pode sabotar seu sono. A regra √©: n√£o se esforce.</p><p class="font-semibold mt-4">O que N√ÉO fazer:</p><ul><li>N√ÉO olhe o rel√≥gio.</li><li>N√ÉO pegue o celular.</li><li>N√ÉO acenda luzes fortes.</li><li>N√ÉO fique se revirando na cama por mais de 20 minutos.</li></ul><p class="font-semibold mt-4">O que FAZER:</p><ul><li>Levante-se, v√° para outro c√¥modo com pouca luz e fa√ßa algo mon√≥tono.</li><li>Relaxe, mesmo acordado. O descanso parcial j√° √© ben√©fico.</li><li>Pratique a respira√ß√£o 4x4.</li></ul>`},
                    { id: 6, category: "Emerg√™ncia", title: "Respira√ß√£o 4x4", content: `<h3>T√©cnica de Respira√ß√£o 4x4</h3><p>Este m√©todo poderoso acalma o sistema nervoso e baixa a frequ√™ncia card√≠aca, preparando o corpo para dormir.</p><ol class="list-decimal list-inside mt-2 space-y-2"><li><strong>Inspire</strong> lentamente pelo nariz contando at√© 4.</li><li><strong>Segure</strong> o ar nos pulm√µes contando at√© 4.</li><li><strong>Expire</strong> lentamente pela boca contando at√© 4.</li><li><strong>Mantenha</strong> os pulm√µes vazios contando at√© 4.</li></ol><p class="mt-4">Repita o ciclo continuamente at√© se sentir mais calmo e sonolento. A concentra√ß√£o na contagem ajuda a desviar o foco de pensamentos ansiosos.</p>`},
                    { id: 7, category: "H√°bitos", title: "A Armadilha da Tecnologia", content: `<h3>O Inimigo no seu Bolso</h3><p>O celular √© um dos maiores sabotadores do sono por dois motivos:</p><ul><li class="mt-2"><strong>Luz Azul:</strong> Suprime a produ√ß√£o de melatonina, o horm√¥nio do sono, enganando seu c√©rebro para que pense que ainda √© dia.</li><li class="mt-2"><strong>Estimula√ß√£o Mental:</strong> Redes sociais, e-mails e not√≠cias mant√™m seu c√©rebro em estado de alerta, o oposto do necess√°rio para relaxar.</li></ul><p class="mt-4 font-semibold">A regra de ouro: desconecte-se de 30 a 60 minutos antes de deitar.</p>`},
                    { id: 8, category: "H√°bitos", title: "Estimulantes Escondidos", content: `<h3>Cafe√≠na e √Ålcool</h3><p>Cuidado com o que voc√™ consome no fim do dia.</p><ul><li class="mt-2"><strong>Cafe√≠na:</strong> Pode levar at√© 8 horas para sair do seu sistema. Evite qualquer bebida com cafe√≠na ap√≥s as 15h.</li><li class="mt-2"><strong>√Ålcool:</strong> Embora possa dar sonol√™ncia, ele fragmenta o sono e piora a qualidade do descanso na segunda metade da noite.</li></ul>`},
                    { id: 9, category: "H√°bitos", title: "Atividade e Alimenta√ß√£o", content: `<h3>Timing de Exerc√≠cios e Refei√ß√µes</h3><p>A hora em que voc√™ come e se exercita importa.</p><ul><li class="mt-2"><strong>Exerc√≠cio Intenso:</strong> Evite treinos pesados 2-3 horas antes de dormir, pois elevam a temperatura corporal e a frequ√™ncia card√≠aca. Prefira atividades leves.</li><li class="mt-2"><strong>Refei√ß√µes Pesadas:</strong> Fa√ßa sua √∫ltima grande refei√ß√£o pelo menos 3 horas antes de deitar para evitar desconforto e refluxo.</li></ul>`}
                ],
                ritualOptions: [
                    { id: 'ritual_tela', emoji: 'üì±', text: 'Desligar todas as telas' },
                    { id: 'ritual_banho', emoji: 'üõÅ', text: 'Tomar um banho quente' },
                    { id: 'ritual_leitura', emoji: 'üìñ', text: 'Ler um livro de papel' },
                    { id: 'ritual_meditacao', emoji: 'üßò', text: 'Meditar por 10 minutos' },
                    { id: 'ritual_respiracao', emoji: 'üå¨Ô∏è', text: 'Fazer exerc√≠cios de respira√ß√£o' },
                    { id: 'ritual_musica', emoji: 'üé∂', text: 'Ouvir m√∫sica calma' },
                    { id: 'ritual_caderno', emoji: 'üìù', text: 'Anotar preocupa√ß√µes em um caderno' },
                ],
                 planRecommendations: {
                    'Rotina': { title: 'Foco em Rotina', icon: '‚è∞', description: 'Seu rel√≥gio biol√≥gico parece desalinhado. A prioridade √© definir hor√°rios fixos para acordar e dormir, mesmo nos fins de semana.' },
                    'Est√≠mulos': { title: 'Foco em Est√≠mulos', icon: 'üì±', description: 'As telas e atividades noturnas est√£o mantendo seu c√©rebro ativo. Crie um ritual de desacelera√ß√£o sem eletr√¥nicos.' },
                    'Ambiente': { title: 'Foco em Ambiente', icon: 'üåÉ', description: 'Seu quarto pode n√£o ser o santu√°rio ideal. Foque em torn√°-lo 100% escuro, silencioso e com temperatura agrad√°vel.' },
                    'H√°bitos': { title: 'Foco em H√°bitos', icon: '‚òï', description: 'Sua alimenta√ß√£o e consumo de estimulantes no fim do dia podem estar sabotando seu sono. Cuidado com a cafe√≠na!' },
                    'Emerg√™ncia': { title: 'Foco em Despertares', icon: 'üßò', description: 'Sua rea√ß√£o ao acordar √† noite gera ansiedade. Pratique t√©cnicas de relaxamento e a regra dos 20 minutos.' }
                }
            };
            
            const quizContainer = document.getElementById('quiz-container');
            const submitQuizBtn = document.getElementById('submit-quiz');
            let quizAnswers = {};

            function renderQuiz() {
                data.quiz.forEach((q, index) => {
                    const questionBlock = document.createElement('div');
                    questionBlock.className = 'mb-6';
                    let optionsHTML = q.options.map((opt, optIndex) => `
                        <label class="flex items-center bg-[#FDFBF8] border border-gray-200 rounded-lg p-4 mb-2 hover:bg-[#EAE3DC] cursor-pointer transition-colors">
                            <input type="radio" name="question-${index}" value="${optIndex}" class="mr-3 h-4 w-4 text-[#8C7A6B] focus:ring-[#8C7A6B] border-gray-300">
                            <span>${opt}</span>
                        </label>
                    `).join('');

                    questionBlock.innerHTML = `<p class="font-semibold text-lg mb-3">${index + 1}. ${q.question}</p><div>${optionsHTML}</div>`;
                    quizContainer.appendChild(questionBlock);
                });
                
                quizContainer.addEventListener('change', () => {
                    quizAnswers = {};
                    let answeredCount = 0;
                    data.quiz.forEach((_, index) => {
                        const selected = document.querySelector(`input[name="question-${index}"]:checked`);
                        if (selected) {
                            quizAnswers[index] = parseInt(selected.value);
                            answeredCount++;
                        }
                    });
                    submitQuizBtn.disabled = answeredCount !== data.quiz.length;
                });
            }

            function showPlan() {
                const planSection = document.getElementById('plano-de-acao');
                const planContent = document.getElementById('plan-content');
                planContent.innerHTML = '';

                let scores = { 'Rotina': 0, 'Est√≠mulos': 0, 'Ambiente': 0, 'H√°bitos': 0, 'Emerg√™ncia': 0 };

                data.quiz.forEach((q, index) => {
                    const scoreValue = quizAnswers[index];
                    scores[q.category] += scoreValue;
                });

                const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
                
                for(let i = 0; i < 3; i++){
                    const category = sortedScores[i][0];
                    const recommendation = data.planRecommendations[category];
                    const planCard = document.createElement('div');
                    planCard.className = 'bg-white p-6 rounded-lg calm-shadow';
                    planCard.innerHTML = `
                        <div class="text-4xl mb-3">${recommendation.icon}</div>
                        <h3 class="font-bold text-xl mb-2 text-[#4A5568]">${recommendation.title}</h3>
                        <p class="text-gray-600">${recommendation.description}</p>
                    `;
                    planContent.appendChild(planCard);
                }

                planSection.classList.remove('hidden');
                planSection.scrollIntoView({ behavior: 'smooth' });
            }

            submitQuizBtn.addEventListener('click', showPlan);

            const libraryGrid = document.getElementById('library-grid');
            const libraryFilters = document.getElementById('library-filters');
            const categories = [...new Set(data.library.map(item => item.category))];
            
            let activeFilter = 'All';

            function renderLibrary() {
                libraryGrid.innerHTML = '';
                const filteredData = activeFilter === 'All' 
                    ? data.library 
                    : data.library.filter(item => item.category === activeFilter);
                
                filteredData.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'bg-white rounded-lg p-6 calm-shadow cursor-pointer hover:transform hover:-translate-y-1 transition-transform';
                    card.innerHTML = `<h3 class="font-bold text-lg text-[#4A5568]">${item.title}</h3>`;
                    card.addEventListener('click', () => openModal(item));
                    libraryGrid.appendChild(card);
                });
            }
            
            function renderFilters() {
                libraryFilters.innerHTML = '';
                const allButton = document.createElement('button');
                allButton.textContent = 'Todos';
                allButton.className = `px-4 py-2 rounded-full transition-colors ${activeFilter === 'All' ? 'bg-[#8C7A6B] text-white' : 'bg-gray-200 text-gray-700'}`;
                allButton.addEventListener('click', () => {
                    activeFilter = 'All';
                    renderFilters();
                    renderLibrary();
                });
                libraryFilters.appendChild(allButton);

                categories.forEach(category => {
                    const button = document.createElement('button');
                    button.textContent = category;
                    button.className = `px-4 py-2 rounded-full transition-colors ${activeFilter === category ? 'bg-[#8C7A6B] text-white' : 'bg-gray-200 text-gray-700'}`;
                    button.addEventListener('click', () => {
                        activeFilter = category;
                        renderFilters();
                        renderLibrary();
                    });
                    libraryFilters.appendChild(button);
                });
            }

            const modalContainer = document.getElementById('modal-container');
            const modalBody = document.getElementById('modal-body');
            const modalClose = document.getElementById('modal-close');
            
            function openModal(item) {
                modalBody.innerHTML = `
                    <h2 class="text-2xl font-bold text-[#4A5568] mb-4">${item.title}</h2>
                    <div class="prose max-w-none text-gray-700">${item.content}</div>
                `;
                modalContainer.classList.remove('hidden');
                modalContainer.classList.add('flex');
                document.body.style.overflow = 'hidden';
            }

            function closeModal() {
                modalContainer.classList.add('hidden');
                modalContainer.classList.remove('flex');
                document.body.style.overflow = '';
            }

            modalClose.addEventListener('click', closeModal);
            modalContainer.querySelector('.modal-backdrop').addEventListener('click', closeModal);

            const ritualBuilder = document.getElementById('ritual-builder');
            data.ritualOptions.forEach(opt => {
                ritualBuilder.innerHTML += `
                    <label class="flex items-center bg-[#FDFBF8] border border-gray-200 rounded-lg p-3 hover:bg-[#EAE3DC] cursor-pointer">
                        <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-[#8C7A6B] focus:ring-[#8C7A6B]" value="${opt.id}">
                        <span class="mr-3 text-xl">${opt.emoji}</span>
                        <span class="text-gray-700">${opt.text}</span>
                    </label>
                `;
            });

            document.getElementById('save-ritual').addEventListener('click', () => {
                const message = document.getElementById('ritual-saved-message');
                message.classList.remove('hidden');
                setTimeout(() => message.classList.add('hidden'), 3000);
            });
            
            const breathingCircle = document.getElementById('breathing-circle');
            const breathingText = document.getElementById('breathing-text');
            const breathingCircleBg = document.getElementById('breathing-circle-bg');
            let isBreathing = false;
            let breathingInterval;

            function breathAnimation() {
                const states = [
                    { text: "Inspire...", scale: 5 },
                    { text: "Segure", scale: 5 },
                    { text: "Expire...", scale: 1 },
                    { text: "Segure", scale: 1 }
                ];
                let currentState = 0;

                const nextState = () => {
                    const state = states[currentState];
                    breathingText.textContent = state.text;
                    breathingCircle.style.transform = `scale(${state.scale})`;
                    currentState = (currentState + 1) % states.length;
                };

                nextState();
                breathingInterval = setInterval(nextState, 4000);
            }

            breathingCircleBg.parentElement.addEventListener('click', () => {
                if (!isBreathing) {
                    isBreathing = true;
                    breathAnimation();
                } else {
                    isBreathing = false;
                    clearInterval(breathingInterval);
                    breathingText.textContent = 'Clique';
                    breathingCircle.style.transform = 'scale(1)';
                }
            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            
            const checkoutLink = 'https://pay.cakto.com.br/3feqawf_565682';

            document.querySelectorAll('a[href="#oferta"], #open-checkout-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const targetId = btn.getAttribute('href');
                    if(targetId === '#oferta' && btn.id !== 'open-checkout-btn') {
                        const offerSection = document.getElementById('oferta');
                        if (offerSection) {
                            e.preventDefault();
                            offerSection.scrollIntoView({ behavior: 'smooth' });
                        }
                    } else if (btn.id === 'open-checkout-btn') {
                        e.preventDefault();
                        if (!btn.disabled) {
                           window.location.href = checkoutLink;
                        }
                    }
                });
            });
            
            function startCountdown() {
                const topBar = document.getElementById('top-countdown-bar');
                const progressBar = document.getElementById('progress-bar');
                const topHoursEl = document.getElementById('top-hours');
                const topMinutesEl = document.getElementById('top-minutes');
                const topSecondsEl = document.getElementById('top-seconds');

                const countdownWrapper = document.getElementById('countdown-wrapper');
                const expiredElement = document.getElementById('countdown-expired');
                const hoursEl = document.getElementById('hours');
                const minutesEl = document.getElementById('minutes');
                const secondsEl = document.getElementById('seconds');
                const checkoutButton = document.getElementById('open-checkout-btn');
                
                const totalDuration = 24 * 60 * 60 * 1000;
                let countDownDate = localStorage.getItem('countDownDate');

                if (!countDownDate || new Date().getTime() > parseFloat(countDownDate)) {
                    const startTime = new Date().getTime() - (totalDuration * 0.7); 
                    countDownDate = startTime + totalDuration;
                    localStorage.setItem('countDownDate', countDownDate);
                } else {
                    countDownDate = parseFloat(countDownDate);
                }

                topBar.classList.remove('hidden');
                countdownWrapper.classList.remove('hidden');

                const interval = setInterval(() => {
                    const now = new Date().getTime();
                    const distance = countDownDate - now;

                    if (distance < 0) {
                        clearInterval(interval);
                        topBar.classList.add('hidden');
                        countdownWrapper.classList.add('hidden');
                        expiredElement.classList.remove('hidden');
                        if(checkoutButton) {
                            checkoutButton.disabled = true;
                            checkoutButton.classList.add('bg-gray-400', 'hover:bg-gray-400', 'cursor-not-allowed');
                            checkoutButton.innerText = 'Oferta Encerrada';
                        }
                        return;
                    }

                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                    
                    const hoursStr = String(hours).padStart(2, '0');
                    const minutesStr = String(minutes).padStart(2, '0');
                    const secondsStr = String(seconds).padStart(2, '0');

                    hoursEl.textContent = hoursStr;
                    minutesEl.textContent = minutesStr;
                    secondsEl.textContent = secondsStr;
                    
                    topHoursEl.textContent = hoursStr;
                    topMinutesEl.textContent = minutesStr;
                    topSecondsEl.textContent = secondsStr;

                    const progress = ((countDownDate - now) / totalDuration) * 100;
                    progressBar.style.width = Math.max(0, 100 - progress) + '%';


                }, 1000);
            }

            startCountdown();
            renderQuiz();
            renderFilters();
            renderLibrary();
        });
    </script>
</body>
</html>

